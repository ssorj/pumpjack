<?xml version="1.0"?>
<model name="proton">
  Qpid Proton is an event-driven messaging API for building clients,
  brokers, and more.  It uses the AMQP 1.0 wire protocol, so it can
  exchange messages with other components that use the same open
  internet standard.  The Proton API is available in many popular
  programming languages.

  <link href="http://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-overview-v1.0-os.html">AMQP specification</link>
  <link href="https://qpid.apache.org/proton/index.html">Qpid Proton home</link>
  <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/c/api/">Qpid Proton C</link>
  <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/cpp/api/">Qpid Proton C++</link>
  <link href="https://github.com/apache/qpid-proton/tree/master/proton-c/bindings/go">Qpid Proton Go</link>
  <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/java/api/">Qpid Proton Java</link>
  <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/python/api/">Qpid Proton Python</link>
  
  <module name="core">
    The primary entry point for the event-driven API. Most
    applications will import only this module.

    <annotation name="requires">proton.amqp</annotation>

    <group name="model" title="AMQP model entities">
      <class name="container">
        A top-level container of messaging resources.
        
        <group name="basic">
          <constructor/> <!-- XXX -->

          <attribute name="id" type="string">
            A unique identifier
          </attribute>

          <method name="run">
            Start processing events
          </method>
        </group>

        <group name="related-objects">
          <method name="connect" type="@connection"/>
          <method name="listen" type="@acceptor"/>
          <method name="create-receiver" type="@receiver"/>
          <method name="create-sender" type="@sender"/>
          <!-- <attribute name="link-prefix" type="string" mutable="true"/> -->
          <attribute name="reactor" type="@reactor"/>
        </group>
      </class>

      <class name="endpoint">
        The base class for session, connection, and link.

        <group name="endpoint-state">
          <attribute name="state" type="integer" setter="false">
            Local and remote endpoint state.

            State is a bit mask of state bit values.

            A state mask is matched against an endpoint as follows: If the
            state mask contains both local and remote flags, then an exact
            match against those flags is performed. If state contains only
            local or only remote flags, then a match occurs if any of the
            local or remote flags are set respectively. <!-- XXX Huh? -->
          </attribute>

          <attribute name="LOCAL-UNINIT" value="1" type="integer">
            The local endpoint is uninitialized.
          </attribute>

          <attribute name="LOCAL-ACTIVE" value="2" type="integer">
            The local endpoint is active.
          </attribute>

          <attribute name="LOCAL-CLOSED" value="4" type="integer">
            The local endpoint is closed.
          </attribute>

          <attribute name="REMOTE-UNINIT" value="8" type="integer">
            The remote endpoint is uninitialized.
          </attribute>

          <attribute name="REMOTE-ACTIVE" value="16" type="integer">
            The remote endpoint is active.
          </attribute>

          <attribute name="REMOTE-CLOSED" value="32" type="integer">
            The remote endpoint is closed.
          </attribute>

          <!--
          <attribute name="LOCAL-MASK">
            A mask including all LOCAL_ bits (UNINIT, ACTIVE, CLOSED).
          </attribute>

          <attribute name="REMOTE-MASK">
            A mask including all REMOTE_ bits (UNINIT, ACTIVE, CLOSED).
          </attribute>
          -->
        </group>
      </class>

      <class name="connection" type="@endpoint">
        The basis for network communication; it contains sessions.

        <!-- XXX typically corresponds to a TCP connection. -->
        
        <link href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-transport-v1.0-os.html#section-connections">AMQP definition</link>
        <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/c/api/connection_8h.html">C</link>
        <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/cpp/api/classproton_1_1connection.html">C++</link>
        <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/python/api/proton.Connection-class.html">Python</link>

        <group name="basic">
          <attribute name="hostname" type="string" mutable="true">
            The name of the remote peer.
          </attribute>

          <attribute name="user" type="string" mutable="true" nullable="true">
            The user name for authentication.
          </attribute>

          <attribute name="password" type="string" mutable="true" nullable="true">
            The password for authentication.
          </attribute>
          
          <method name="open">
            Initiate connection open.

            This moves the local state of the connection to ACTIVE and
            triggers an open frame to be sent to the peer. A
            connection is fully active once both peers have opened it.

            Not complete until on-connection-opened. <!-- XXX -->
          </method>

          <method name="close">
            Initiate connection close.
          </method>
        </group>

        <group name="related-objects">
          <attribute name="container" type="@container">
            The container which holds this connection.
          </attribute>

          <attribute name="transport" type="@transport">
            The associated transport.
          </attribute>

          <attribute name="default-session" type="@session">
            The session used by create-sender and create-receiver.
          </attribute>

          <method name="create-session">
            Create a session on this connection.

            <output name="session" type="@session"/>
          </method>

          <method name="create-sender">
            Create a sender using the default session.

            <input name="address" type="string"/>
            <input name="handler" type="@handler" nullable="true"/>
            <output name="sender" type="@sender"/>
          </method>

          <method name="create-receiver" type="@receiver">
            Create a receiver using the default session.

            <input name="address" type="string"/>
            <input name="dynamic" value="false" type="boolean"/>
            <input name="handler" type="@handler" nullable="true"/>
            <output name="receiver" type="@receiver"/>
          </method>
        </group>

        <group name="endpoint-state">
          <attribute name="remote-container-id"/>
          <attribute name="remote-hostname"/>
          <attribute name="remote-properties"/>
        </group>

        <group name="error-handling">
          <attribute name="condition" type="@condition"/>
          <attribute name="remote-condition"/>
        </group>

        <!--
        <group name="connection-capabilities" title="Connection capabilities">
          <attribute name="offered-capabilities" type="list">
            Extension capabilities the connection initiator supports.
          </attribute>
          
          <attribute name="desired-capabilities" type="list">
            Extension capabilities the connection initiator can use.
          </attribute>

          <attribute name="remote-offered-capabilities">
          </attribute>
          
          <attribute name="remote-desired-capabilities">
          </attribute>
        </group>
        -->
      </class>

      <class name="session" type="@endpoint">
        A container of links

        <link href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-transport-v1.0-os.html#section-sessions">AMQP definition</link>
        <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/c/api/session_8h.html">C</link>
        <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/cpp/api/classproton_1_1session.html">C++</link>
        <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/python/api/proton.Session-class.html">Python</link>
        
        <group name="basic">
          <method name="open"/>
          <method name="close"/>
        </group>

        <group name="related-objects">
          <attribute name="connection" type="@connection"/>
          <method name="create-receiver" type="@receiver"/>
          <method name="create-sender" type="@sender"/>
        </group>

        <group name="flow-control">
          <attribute name="incoming-bytes" type="integer"/>
          <attribute name="incoming-capacity" type="integer"/>
          <attribute name="outgoing-bytes" type="integer"/>
          <attribute name="outgoing-window" type="integer"/>
        </group>
      </class>
      
      <class name="link" type="@endpoint">
        A named channel for sending or receiving messages.

        <link href="https://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-transport-v1.0-os.html#section-links">AMQP definition</link>
        <link href="https://qpid.apache.org/releases/qpid-proton-master/proton/c/api/link_8h.html">C</link>
        <link href="http://qpid.apache.org/releases/qpid-proton-master/proton/cpp/api/classproton_1_1link.html">C++</link>
        <link href="http://qpid.apache.org/releases/qpid-proton-master/proton/python/api/proton.Link-class.html">Python</link>

        <group name="basic">
          <attribute name="name" type="string"/>
          <method name="open"/>
          <method name="close"/>
        </group>

        <group name="related-objects">
          <attribute name="connection" type="@connection"/>
          <attribute name="local-source" type="@terminus"/>
          <attribute name="local-target" type="@terminus"/>
          <attribute name="remote-source" type="@terminus"/>
          <attribute name="remote-target" type="@terminus"/>
        </group>

        <group name="flow-control">
          <attribute name="credit" type="integer"/>
        </group>

        <group name="event-processing">
          <attribute name="handler" type="@base-handler" mutable="true"/>
        </group>
      </class>

      <class name="receiver" type="@link">
        A link for receiving messages
        
        <group name="flow-control">
          <method name="flow">
            Issue credit on the link.
          </method>
        </group>
      </class>
      
      <class name="sender" type="@link">
        A link for sending messages.

        <group name="basic">
          <method name="send">
            Send a message on the link.
          </method>
        </group>
      </class>
      
      <class name="terminus">
        One end of a link, either a source or a target.

        <group name="basic">
          <attribute name="address" type="string" mutable="true"/>
          <attribute name="dynamic" type="boolean" mutable="true"/>
        </group>

        <group name="other">
          <attribute name="distribution-mode" mutable="true"/>
          <attribute name="expiry-policy" mutable="true"/>
          <attribute name="type" mutable="true"/>
        </group>
      </class>
      
      <class name="condition">
        An endpoint error state.
      </class>
      
      <class name="delivery">
        The state of a message transfer.

        <group name="basic">
          <attribute name="tag"/>
        </group>

        <group name="related-objects">
          <attribute name="link" type="@link"/>
          <attribute name="session" type="@session"/>
          <attribute name="connection" type="@connection"/>
          <attribute name="transport" type="@transport"/>
        </group>

        <group name="state-changes">
          <attribute name="local-state" mutable="true"/>
          <attribute name="remote-state"/>
          <method name="accept"/>
          <method name="reject"/>
          <method name="release"/>
          <method name="modify"/>
          <method name="update-remote-state"/>
        </group>
      </class>

      <class name="message">
        An application-defined unit of communication.

        <!-- XXX a message is a value object -->

        <link href="http://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#section-message-format">AMQP definition</link>

        <group name="identity-properties">
          <attribute name="id" mutable="true"/>
          <attribute name="correlation-id" mutable="true"/>
          <attribute name="user-id" type="string" mutable="true"/>
        </group>

        <group name="routing-properties">
          <attribute name="address" mutable="true"/>
          <attribute name="reply-to" mutable="true"/>
        </group>

        <group name="content-properties">
          <attribute name="subject" mutable="true"/>
          <attribute name="body" mutable="true"/>
          <attribute name="content-encoding" mutable="true"/>
          <attribute name="content-type" mutable="true"/>
          <attribute name="inferred" mutable="true"/>
          <attribute name="expiry-time" mutable="true"/>
          <attribute name="creation-time" mutable="true"/>
        </group>

        <group name="message-group-properties">
          <attribute name="group-id" mutable="true"/>
          <attribute name="group-sequence" mutable="true"/>
          <attribute name="reply-to-group-id" mutable="true"/>
        </group>

        <group name="message-transfer-headers" title="Message transfer headers">
          <link href="http://docs.oasis-open.org/amqp/core/v1.0/os/amqp-core-messaging-v1.0-os.html#type-header">AMQP spec</link>
          
          <attribute name="durable" value="false" type="boolean" mutable="true">
            Durability requirement.  A durable message is saved even
            if an intermediary is unexpectedly terminated and
            restarted.
          </attribute>

          <attribute name="priority" value="4" mutable="true" type="integer" nullable="true">
            Relative message priority.  Higher numbers indciate higher
            priority.
          </attribute>

          <attribute name="ttl" mutable="true" type="integer" nullable="true">
            The time to live.  The message must be discarded after
            'ttl' milliseconds.
          </attribute>

          <attribute name="first-acquirer" type="boolean" mutable="true" nullable="true"/>

          <attribute name="delivery-count" type="integer" mutable="true">
            The number of prior unsuccessful delivery attempts.
          </attribute>
        </group>

        <group name="encoding">
          <method name="encode"/>
          <method name="decode"/>
        </group>

        <group name="delivery-annotations">
          <method name="get-delivery-annotation"/>
          <method name="set-delivery-annotation"/>
        </group>

        <group name="message-annotations">
          <method name="get-message-annotation"/>
          <method name="set-message-annotation"/>
        </group>

        <group name="application-properties">
          <method name="get-application-property"/>
          <method name="set-application-property"/>
        </group>
      </class>
    </group>

    <group name="events" title="Event processing">
      <class name="event"/>
      <class name="event-type"/>
      <class name="collector"/>
      <class name="reactor"/>
      <class name="acceptor"/>
      <class name="timer"/>
      <class name="task"/>
      <class name="selectable"/>
      <class name="general-handler"/>
      <class name="outgoing-message-handler"/>
      <class name="incoming-message-handler"/>
      <class name="transaction-handler"/>
      <class name="transactional-client-handler"/>
    </group>

    <group name="transport" title="Transport entities">
      <class name="transport"/>
      <class name="transport-error"/>
      <class name="ssl"/>
      <class name="ssl-domain"/>
      <class name="ssl-error"/>
      <class name="sasl"/>
    </group>

    <group name="errors" title="Error handling">
      <class name="proton-error"/>
      <class name="timeout-error"/>
    </group>

    <group name="utilities" title="Important utilities">
      <class name="duration"/>
      <class name="url"/>
      <class name="url-error"/>
    </group>
  </module>

  <module name="amqp">
    AMQP data encoding and decoding. For typical Proton-based
    applications, these classes will not be used directly.

    <annotation name="requires">proton.internal</annotation>
  </module>
  
  <module name="internal">
    API internals and language extensions.  These are classes that are
    necessary for the implementation, but not promoted for general
    consumption by API users.
  </module>

  <type name="string"/>
  <type name="boolean"/>
  <type name="integer"/>
  <type name="any"/>
  <type name="class"/>

  <group-definition name="basic" title="Identity and lifecycle">
    Attributes and methods that determine basic object behaviors.
  </group-definition>

  <group-definition name="related-objects" title="Related objects">
    Attributes for navigating to related objects and methods for
    creating new ones.
  </group-definition>

  <group-definition name="endpoint-state" title="Endpoint state">
  </group-definition>

  <group-definition name="event-processing" title="Event processing">
  </group-definition>

  <group-definition name="error-handling" title="Error handling">
  </group-definition>

  <group-definition name="flow-control" title="Flow control">
  </group-definition>
</model>
